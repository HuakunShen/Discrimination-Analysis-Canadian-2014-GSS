---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Lantao Cui
  - Huakun Shen
  - Sijian Wu
thanks: "Code and data are available at: LINK."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---


## Table of Contents
### 1  Introduction\
------------------------------------------------------------------------------------------------2

### 2  Data
##### 2.1 Data Source\
------------------------------------------------------------------------------------------------3

##### 2.2 Methodology and Data Collection\
------------------------------------------------------------------------------------------------3

##### 2.3 Data Characteristics\
------------------------------------------------------------------------------------------------5

### 3 Limitations and Conclusion\
------------------------------------------------------------------------------------------------9

### 4 Reference\
------------------------------------------------------------------------------------------------10
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(ggplot2)
library(kableExtra)
library(here)

```

# Introduction

You can and should cross-reference sections and sub-sections. For instance, Section \@ref(data). R Markdown automatically makes the sections lower case and adds a dash to spaces to generate labels, for instance, Section \@ref(first-discussion-point). 



# Data
We started our analysis by using R [@citeR], dplyr[@dplyr], tidyverse[@tidyverse], here[@here]. Graphs are generated using and ggplot2[@ggplot2] and kableExtra[@kableExtra].

## Data Source
We retrieved our data from CHASS [@chass]. Among all the available data in the Canadian General Social Survey(Victimization), we decide to choose the following subset: *DIS: Discrimination*, *DTS: Discrimination - Types of Situations experienced by respondent*, *CIP: Confidence In Police*, *DEM: Demographic Derived Variables*, *PCC: Perceptions: Criminal Courts*, *PLP: Perceptions: Local Police*, *TIP: Trust In People*. The GSS program, established in 1985, conducts surveys annually across the 10 provinces. The GSS is recognized for its regular collection of cross-sectional data that allows for trend analysis, and its capacity to test and develop new concepts that address current and emerging issues. The two primary objectives of the General Social Survey are: 
a)  to gather data on social trends in order to monitor changes in the living conditions and well-being 
of Canadians over time; and 
b)  to provide immediate information on specific social policy issues of current or emerging interest. 

To meet these objectives, the data collected by the GSS are made up of two components: classification and core content. Classification content (such as age, sex, education, income) helps to delineate population groups for use in the analysis of core data. Core content is designed to measure changes in society related to living conditions and well-being and to supply data to inform specific policy issues[@chass]. 

Data for 2014 General Social Survey (GSS) on Canadians’ Safety and Security (Victimization) was collected from January to December, 2014. The survey collected a large amount of information for each selected respondent as well as some information about each member of the respondent’s household. The overall response rate was 52.9%. The target population for the Cycle 28 GSS included all persons 15 years of age and older in Canada, excluding: 
1. Residents of the Yukon, Northwest Territories, and Nunavut; 
2. Full-time residents of institutions. 
The survey frame was created using two different components: 
•  Lists of telephone numbers in use (both landline and cellular) available to Statistics Canada from various sources (Telephone companies, Census of population, etc.); 
•  The Address Register (AR): List of all dwellings within the ten provinces. 


## Methodology and Data Collection

```{r, include=FALSE, warning=FALSE}
gss_data <-
  read_csv(here::here("inputs/data/data.csv"))
glimpse(gss_data)
```

```{r, include=FALSE}
#Renaming the variables according to the code book by using the function "rename". 
#Select needed variables for analysis from the aspect of discrimination by using the function"select"
gss_data_renamed <- gss_data %>%
  rename(Sex = dis_10, Ethnicity_or_Culture = dis_15, Race_or_Skin_Colour = dis_20, Physical_Appearance = dis_25, Religion = dis_30, Sexual_Orientation = dis_35, Age = dis_40, Physical_or_Mental_Disability = dis_45, Language = dis_50, Other_Discrimination = dis_55, Victim_of_Discrimination_5_years = discrim, Bank_Store_Restaurant = dts_20, Work_Environment = dts_25, Police = dts_30, Courts = dts_35, Canadian_Border = dts_60, Other_Experience = dts_65) %>%
  select (Sex, Ethnicity_or_Culture, Race_or_Skin_Colour, Physical_Appearance, Religion, Sexual_Orientation, Age, Physical_or_Mental_Disability, Language, Other_Discrimination, Victim_of_Discrimination_5_years, Bank_Store_Restaurant, Work_Environment, Police, Courts, Canadian_Border, Other_Experience)

colnames(gss_data_renamed)
class(gss_data_renamed$Ethnicity_or_Culture)
```

```{r, include=FALSE}
  data_cleaned <-  gss_data_renamed %>%
  mutate( Discrimination_Reason =
           case_when(Sex == 1 ~ "Sex",
                     Ethnicity_or_Culture == 1 ~ "Ethnicity",
                     Race_or_Skin_Colour == 1 ~ "Race",
                     Physical_Appearance == 1 ~ "Physical Appearance",
                     Religion == 1 ~ "Religion",
                     Sexual_Orientation == 1 ~ "Sexual Orientation",
                     Age == 1 ~ "Age",
                     Physical_or_Mental_Disability == 1 ~ "Disability",
                     Language == 1 ~ "Language",
                     Other_Discrimination == 1 ~ "Other"
                     )) %>%
  mutate (Discrimination_Experience = 
            case_when(Bank_Store_Restaurant == 1 ~ "Bank or Store or Restaurant",
                      Work_Environment == 1 ~ "Work Environment",
                      Police == 1 ~ "Police",
                      Courts == 1 ~ "Courts",
                      Canadian_Border == 1 ~ "Cannadian Border",
                      Other_Experience == 1 ~ "Other Experience"
              
            ))%>%
  mutate(Have_Discrimination_Experience_in_5_years = Victim_of_Discrimination_5_years == 1)


```

The survey started with an entry section. The purpose of this section is to introduce the survey and select a respondent. A Household Roster is created, which collects key demographic information on each member of the household, including age, sex and marital status. Selected respondents are asked for their birth date and confirmation of their age (ANC). They are also asked to confirm their marital status (CMR) if another household member provided the roster information. Age and marital status are used to determine if certain questions are asked later in the survey. Age and date of birth are also used for certain derived variables and to validate responses where ages are involved[@chass].

When a probability sample is used, as is the case for the GSS, the principle behind estimation is that each person selected in the sample represents (in addition to himself or herself) several other persons not in the sample. Computer assisted telephone interviewing (CATI) was used to collect data for the 2014 GSS VIC. Respondents were interviewed in the official language of their choice. Proxy interviews were not permitted. In each frame, each record was assigned to a stratum within its province. A simple random sample without replacement of records was next selected in each stratum. Only specific geographies were targeted for the oversample of immigrants and youth[@chass].

Coverage of the 2014 GSS on Canadians’ Safety and Security (Victimization) targeted population by the survey frame is estimated to be more than 86% complete. All respondents in the ten provinces were interviewed by telephone. Households without telephones were therefore excluded. During collection, for the households not meeting the eligibility criteria, the interviews were terminated after an initial set of questions that established whether or not they met the criteria. For the oversample cases, an extra question was asked to determine if each person in the household was born in Canada or not. For the 2014 GSS on Canadians’ Safety and Security (Victimization), 81.5% of the telephone numbers dialed reached eligible households. An attempt was then made to conduct an interview with one randomly selected person from each household. Interviewers were instructed to make all reasonable attempts to obtain a completed interview with the randomly selected member of the household. Those who at first refused to participate were re-contacted up to two more times to explain the importance of the survey and to encourage their participation[@chass].

The target sample size (i.e. the number of respondents) for Cycle 28 on Canadians’ Safety and Security (Victimization) was 39,674, while the actual number of respondents was 33,127. Some GSS respondents were removed from the PUMF for confidentiality reasons. GSS Cycle 28 PUMF contains questionnaire responses and associated information from 33,089 respondents. For each province, minimum sample sizes were determined that would ensure certain estimates would have acceptable sampling variability at the stratum level. Once these stratum sample size targets had been met, the remaining sample was allocated to the strata in a way that balanced the need for precision of both national-level and stratum-level estimates[@chass].

One of the strengths of this survey is that it captures various potential factors that could have significant relationship with victimization. Also, it mainly focuses on gathering information within 5 years which is a more accurate approach for the respondent to retrieve a recent memory. However, this also comes with a trade-off that we could not compare the information in earlier periods. Dealing with non-responses is a common problem for every survey. In the GSS, the answers for each question provided different situations for the respondent to choose including Yes, No, Valid skip, Don’t know, Refusal, and Not stated. As a result, even though the existence of non-response could not be eliminated, the gathered data would provide a good sense of why the respondent could not offer a clear answer.

Another trade-off is that the general social survey is a relatively long to capture various information which may lead to impatience of answering and errors in responding. Typically, long questionnaires could involve a fake question to check if the respondent is reading the questions carefully and providing sincere answers. For some scenario questions, investigators like us would also like to obtain further elaborations. So we also include a supplementary survey to gather more detailed information about discriminations.




\newpage
# Results

## Classification of Discrimination
The identification of discrimination could be vague and inconsistent in different regions. According to Human rights in Ontario[@humanrights], there are four forms of discrimination: direct, indirect, subtle, and adverse effect discrimination; Harassment; Poisoned environment; Systemic discrimination. Discrimination often derives from different backgrounds and identities. Based on unique combination of identities, people may be exposed to specific forms of discrimination and may experience significant personal harm. The 2014 GSS on Canadians’ Safety and Security (Victimization) mainly captured gender, disability, and ethnicity. It also provides information of the condition when discrimination happens. According to Figure \@ref(fig:discrimination-reason), the most common reason of discrimination within 5 years is sex and ethnicity. In addition, physical appearance, age and language are also typical reasons of discrimination.


```{r, discrimination-reason, fig.cap="discrimination Reason", echo=FALSE, warning=FALSE}
ggplot(data = data_cleaned) + 
  geom_histogram(aes(x = Have_Discrimination_Experience_in_5_years, fill = Discrimination_Reason), 
                 position = 'dodge', 
                 bins = 10) + 
  theme(axis.text.x=element_blank()) +
  scale_x_log10()
```

Under many circumstances, the government has established regulations to protect human rights. For example, the Canadian Human Rights Act is a broad-reaching piece of legislation that prohibits discrimination on the basis of gender, race, ethnicity and other grounds. Also, Canada's Employment Equity Act and the Federal Contractors Program require employers to take active measures to improve the employment opportunities for specific groups of people in our country. Both the labour rights and responsibilities of employers and employees within federally regulated sectors fall under the Canada Labour Code. The rights of foreign workers in Canada are also protected under federal or provincial/territorial labour laws. However, we could still see that discrimination experience is significantly common under working environment in \@ref(fig:discrimination-experience). Bank, store, and restaurant are the most common location for discrimination to take place while the Canadian border and courts are the least common location for discrimination to happen.

```{r, discrimination-experience, fig.cap="discrimination Experience", echo=FALSE, warning=FALSE}
ggplot(data = data_cleaned) + 
  geom_histogram(aes(x = Have_Discrimination_Experience_in_5_years, fill = Discrimination_Experience), 
                 position = 'dodge', 
                 bins = 10) +
  theme(axis.text.x=element_blank()) +
  scale_x_log10()
```

## Impact of Gender on People's Confidence in Law Enforcement 
After noting that the majority of discriminating cases are gender discrimination. We are wondering if this will also be reflected in people's confidence in Law Enforcement. To be a specific, if a certain gender group are more vulnerable to discrimination, will that group also be treated unfairly during law enforcement? To investigate this, we extracted some other survey results from Canadian General Social Survey. We will first find the number of each gender in the survey, if the number of respondents from each gender groups are uneven, then the result might be biased toward a gender group. After analyzing the survey data set, the following gender distribution is found, as shown in Figure \@ref(fig:gender-distribution). From the figure, we can see that the gender distribution are about the same, so we can proceed to further investigation.



```{r, include=FALSE}
input_csv <- read_csv(here::here(
  "inputs/data/The_Impact_of_sex_on_confidence_in_government.csv"
))

gender_group <- count(input_csv, sex)
gender_group$sex[gender_group$sex==2] <- "Female"
gender_group$sex[gender_group$sex==1] <- "Male"
```

```{r, gender-distribution, fig.cap='Gender Distribution', echo=FALSE, warning=FALSE, message = FALSE, fig.width=10, fig.height=5, fig.pos = "!H"}

ggplot(data=gender_group, aes(x=sex, y=n)) +
  geom_bar(stat="identity")

```

## Confidence In Police
Now we will investigate people's confidence in police in different gender groups. People's response are categorized into 8 groups: *1  A great deal of confidence*, *2  Some confidence*, *3  Not very much confidence*, *4  No confidence at all*, *6  Valid skip*, *7  Don't know*, *8  Refusal*, *9  Not stated*. The following bar graph shows the distribution of the responses, categorized by gender groups, as shown in Figure \@ref(fig:cip-distribution). From the graph, we can see that the majority of respondents are confident in local police. To be specific, 92.8% of female show some or great confidence in local police, whereas 90% of male show some or great confidence in local police.

```{r, include= FALSE}
myvars <- c("sex", "cip_10")
cip_based_on_gender <- input_csv[myvars]
cip_based_on_gender<-cip_based_on_gender[!cip_based_on_gender$cip_10>=6,]
cip_based_on_gender$sex[cip_based_on_gender$sex==2] <- "Female"
cip_based_on_gender$sex[cip_based_on_gender$sex==1] <- "Male"
cip_based_on_gender$cip_10[cip_based_on_gender$cip_10==1] <- "Great confidence"
cip_based_on_gender$cip_10[cip_based_on_gender$cip_10==2] <- "Some confidence"
cip_based_on_gender$cip_10[cip_based_on_gender$cip_10==3] <- "Small confidence"
cip_based_on_gender$cip_10[cip_based_on_gender$cip_10==4] <- "No confidence"

cip_count_based_on_gender <- table(cip_based_on_gender$sex, cip_based_on_gender$cip_10)

```


```{r, cip-distribution, fig.cap='Confidence in Police Distribution', echo=FALSE, warning=FALSE, message = FALSE, fig.width=10, fig.height=7, fig.pos = "!H"}

barplot(cip_count_based_on_gender, main="Confidence In Police Distribution",
  xlab="Confidence Level", col=c("darkblue","red"), cex.names=.8,
  legend = rownames(cip_count_based_on_gender), horiz=TRUE, beside=TRUE)
```

Next, we will take a closer look at the responses of two other questions, they are *Perception (local police) - Being approachable and easy to talk to* and *Perception (local police) - Treating people fairly*. Those questions, especially the second one, will allow us to have more certainty in determining whether people in different gender groups are treated unfairly in Law Enforcement. Both of the questions have 7 valid choices, they are *1  Good job*, *2  Average job*, *3 Poor job*, *6  Valid skip*, *7  Don't know*, *8  Refusal*, *9  Not stated*. For simplicity, we will only consider the first 3. The distribution of the responses is shown in Figure \@ref(fig:pip-distribution1) and Figure \@ref(fig:pip-distribution2). From the figures, around 81% of male respondents think that police are approachable and around 80% of female respondents hold the same opinion. On top of that, around 77% of female respondents think that police treat people fairly and around 79% of male respondents hold the same opinion. In Conclusion, based on the results of the survey, majority of the respondents from all participating gender groups have confidence in police and agree that police is approachable and treat people fairly.

```{r, include = FALSE}
myvars <- c("sex", "plp_130", "plp_140")
pip_based_on_gender <- input_csv[myvars]
pip_based_on_gender<-pip_based_on_gender[!(pip_based_on_gender$plp_130>=6 | pip_based_on_gender$plp_140>=6),]
pip_based_on_gender$sex[pip_based_on_gender$sex==2] <- "Female"
pip_based_on_gender$sex[pip_based_on_gender$sex==1] <- "Male"
pip_based_on_gender$plp_130[pip_based_on_gender$plp_130==1] <- "Good Job"
pip_based_on_gender$plp_130[pip_based_on_gender$plp_130==2] <- "Average Job"
pip_based_on_gender$plp_130[pip_based_on_gender$plp_130==3] <- "Poor Job"

pip_based_on_gender$plp_140[pip_based_on_gender$plp_140==1] <- "Good Job"
pip_based_on_gender$plp_140[pip_based_on_gender$plp_140==2] <- "Average Job"
pip_based_on_gender$plp_140[pip_based_on_gender$plp_140==3] <- "Poor Job"

pip_count_based_on_gender_130 <- table(pip_based_on_gender$sex, pip_based_on_gender$plp_130)
pip_count_based_on_gender_140 <- table(pip_based_on_gender$sex, pip_based_on_gender$plp_140)

```

```{r, pip-distribution1, fig.cap='Police is approachable', echo=FALSE, warning=FALSE, message = FALSE, fig.width=10, fig.height=7, fig.pos = "!H"}

barplot(pip_count_based_on_gender_130, main="Police is Approachable and Polite",
  xlab="Confidence Level", col=c("darkblue","red"), cex.names=.8,
  legend = rownames(pip_count_based_on_gender_130), horiz=TRUE, beside=TRUE)
```


```{r, pip-distribution2, fig.cap='Police Treats People Fairly', echo=FALSE, warning=FALSE, message = FALSE, fig.width=10, fig.height=7, fig.pos = "!H"}

barplot(pip_count_based_on_gender_140, main="Police Treats People Fairly",
  xlab="Confidence Level", col=c("darkblue","red"), cex.names=.8,
  legend = rownames(pip_count_based_on_gender_140), horiz=TRUE, beside=TRUE)
```

\newpage

## Confidence In Criminal Courts
After investigating different gender group's confidence in police, we will now take a look at people's confidence in criminal courts. Similarly, we will only look at the following three responses: *1  A great deal of confidence*,
*2  Some confidence*, *3  Not very much confidence*, Figure \@ref(fig:pip-distribution3) shows the result.

```{r, include = FALSE}
myvars <- c("sex", "pcc_145")
conf_in_court_based_on_gender <- input_csv[myvars]
conf_in_court_based_on_gender<-conf_in_court_based_on_gender[!(conf_in_court_based_on_gender$pcc_145>=6),]
conf_in_court_based_on_gender$sex[conf_in_court_based_on_gender$sex==2] <- "Female"
conf_in_court_based_on_gender$sex[conf_in_court_based_on_gender$sex==1] <- "Male"
conf_in_court_based_on_gender$pcc_145[conf_in_court_based_on_gender$pcc_145==1] <- "Great Confidence"
conf_in_court_based_on_gender$pcc_145[conf_in_court_based_on_gender$pcc_145==2] <- "Some Confidence"
conf_in_court_based_on_gender$pcc_145[conf_in_court_based_on_gender$pcc_145==3] <- "Not Very Much Confidence"
conf_in_court_based_on_gender$pcc_145[conf_in_court_based_on_gender$pcc_145==4] <- "No Confidence"

conf_in_court_based_on_gender <- table(conf_in_court_based_on_gender$sex, conf_in_court_based_on_gender$pcc_145)

```

```{r, pip-distribution3, fig.cap='Confidence in Criminal Courts', echo=FALSE, warning=FALSE, message = FALSE, fig.width=10, fig.height=7, fig.pos = "!H"}

barplot(pip_count_based_on_gender_140, main="Confidence in Criminal Courts",
  xlab="Confidence Level", col=c("darkblue","red"), cex.names=.8,
  legend = rownames(pip_count_based_on_gender_140), horiz=TRUE, beside=TRUE)
```

\newpage


# Discussion

## Gender Discrimination in Law Enforcement

Based on results of the survey, every gender group have a similar perception in police and criminal courts. However, it is still too early to conclude that there are no gender discrimination during law enforcement because of the limitations in the survey. In the original survey, when people are asked for their gender, only Male and Female are available to choose from, the other options are either "Valid Skip" or "Refusal", as a result, every survey respondent chose either "Male" or "Female". This makes the results very biased. Suppose that all the *Poor Job* votes are from a minority gender group, the results become deceptive because they were not able to select their own gender. 


# Reference


