---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Lantao Cui
  - Huakun Shen
  - Sijian Wu
thanks: "Code and data are available at: LINK."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---


## Table of Contents
### 1  Introduction\
------------------------------------------------------------------------------------------------2

### 2  Data
##### 2.1 Data Source\
------------------------------------------------------------------------------------------------3

##### 2.2 Methodology and Data Collection\
------------------------------------------------------------------------------------------------3

##### 2.3 Data Characteristics\
------------------------------------------------------------------------------------------------5

### 3 Limitations and Conclusion\
------------------------------------------------------------------------------------------------9

### 4 Reference\
------------------------------------------------------------------------------------------------10
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(ggplot2)
library(kableExtra)
library(here)

```

# Introduction

You can and should cross-reference sections and sub-sections. For instance, Section \@ref(data). R Markdown automatically makes the sections lower case and adds a dash to spaces to generate labels, for instance, Section \@ref(first-discussion-point). 



# Data
We started our analysis by using R [@citeR], dplyr[@dplyr], tidyverse[@tidyverse], here[@here]. Graphs are generated using and ggplot2[@ggplot2] and kableExtra[@kableExtra].

## Date Source

## Methodology and Data Collection

```{r, include=FALSE, warning=FALSE}
gss_data <-
  read_csv(here::here("inputs/data/Discrimination.csv"))
glimpse(gss_data)
```

```{r, include=FALSE}
#Renaming the variables according to the code book by using the function "rename". 
#Select needed variables for analysis from the aspect of discrimination by using the function"select"
gss_data_renamed <- gss_data %>%
  rename(Sex = dis_10, Ethnicity_or_Culture = dis_15, Race_or_Skin_Colour = dis_20, Physical_Appearance = dis_25, Religion = dis_30, Sexual_Orientation = dis_35, Age = dis_40, Physical_or_Mental_Disability = dis_45, Language = dis_50, Other_Discrimination = dis_55, Victim_of_Discrimination_5_years = discrim, Bank_Store_Restaurant = dts_20, Work_Environment = dts_25, Police = dts_30, Courts = dts_35, Canadian_Border = dts_60, Other_Experience = dts_65) %>%
  select (Sex, Ethnicity_or_Culture, Race_or_Skin_Colour, Physical_Appearance, Religion, Sexual_Orientation, Age, Physical_or_Mental_Disability, Language, Other_Discrimination, Victim_of_Discrimination_5_years, Bank_Store_Restaurant, Work_Environment, Police, Courts, Canadian_Border, Other_Experience)

colnames(gss_data_renamed)
class(gss_data_renamed$Ethnicity_or_Culture)
```

```{r, include=FALSE}
  data_cleaned <-  gss_data_renamed %>%
  mutate( Discrimination_Reason =
           case_when(Sex == 1 ~ "Sex",
                     Ethnicity_or_Culture == 1 ~ "Ethnicity",
                     Race_or_Skin_Colour == 1 ~ "Race",
                     Physical_Appearance == 1 ~ "Physical Appearance",
                     Religion == 1 ~ "Religion",
                     Sexual_Orientation == 1 ~ "Sexual Orientation",
                     Age == 1 ~ "Age",
                     Physical_or_Mental_Disability == 1 ~ "Disability",
                     Language == 1 ~ "Language",
                     Other_Discrimination == 1 ~ "Other"
                     )) %>%
  mutate (Discrimination_Experience = 
            case_when(Bank_Store_Restaurant == 1 ~ "Bank or Store or Restaurant",
                      Work_Environment == 1 ~ "Work Environment",
                      Police == 1 ~ "Police",
                      Courts == 1 ~ "Courts",
                      Canadian_Border == 1 ~ "Cannadian Border",
                      Other_Experience == 1 ~ "Other Experience"
              
            ))%>%
  mutate(Have_Discrimination_Experience_in_5_years = Victim_of_Discrimination_5_years == 1)


```





```{r, echo=FALSE, warning=FALSE}
ggplot(data = data_cleaned) + 
  geom_histogram(aes(x = Have_Discrimination_Experience_in_5_years, fill = Discrimination_Reason), 
                 position = 'dodge', 
                 bins = 10) + 
  theme(axis.text.x=element_blank()) +
  scale_x_log10()
```

```{r, echo=FALSE, warning=FALSE}
ggplot(data = data_cleaned) + 
  geom_histogram(aes(x = Have_Discrimination_Experience_in_5_years, fill = Discrimination_Experience), 
                 position = 'dodge', 
                 bins = 10) +
  theme(axis.text.x=element_blank()) +
  scale_x_log10()
```


# Results

# Discussion

## First discussion point



## Second discussion point

## Third discussion point

## Weaknesses and next steps






\newpage


# References


